---
layout : post
title : IOT 8일차 TIL
description : 부경대학교 윈도우 플랫폼기반 IOT 시스템 개발자 과정 TIL
summary : 개발환경 구축
tags : [TIL, DE]
---
  
-------------
   
   
### 📓 공부한 내용 [blog](https://canyougivemeonelastkiss.tistory.com/26)
  
  urllib를 이용한 웹 크롤링 [git](https://github.com/drown-ed/IOT-study/blob/main/python-basic/230208/web_crawling.ipynb)  
    
  OpenAPI를 이용한 웹 크롤링 [git](https://github.com/drown-ed/IOT-study/blob/main/python-basic/230208/openapi_crawling.ipynb)  
    ㄴ data.go.kr 에서 부산광역시 버스정보안내기 현황 API를 사용허가 받아서 사용.  
    ㄴ 사이트 내에서 미리보기가 가능한 줄은 처음 알았다.  
  
  Beautiful Soup를 이용한 웹 크롤링 [git](https://github.com/drown-ed/IOT-study/blob/main/python-basic/230208/beautifulsoup.ipynb)  
    

### 💦 어려웠던 내용 

  OpenAPI 사용 시 ssl 인증서 관련 오류를 뱉으며 실행되지 않았다. 오류 메시지를 검색해서 여러 수정을 가한 결과 Colab에서는 정상적으로 실행이 되었는데 컴퓨터 환경에서는 실행되지 않았다. 파이썬 버전이 서로 다르기 때문이라는 가설을 세워봤고, 파이썬 버전을 낮추는 것으로 실행되는지 시험해보는 게 좋을 것 같다. 결국 request.get 함수에서 verify = False 파라미터를 사용해 검증을 꺼서 실행시켰다.  
  
  ```
  response = requests.get(total_url, verify = False)
  ```
  
### 🧷 궁금한 내용  부족한 내용 
  
  블로그에도 기재해놓은 것처럼 버스정보안내기 현황 API에서 뽑아낸 정보를 folium을 연동시켰을 때 거리가 가장 먼 두 지점의 차이를 잡아 zoom_start 파라미터를 유동적으로 입력할 수 있게 한다면 사용자 입장에서 보기 편할 것 같다. 한 번 구현해보면 좋겠다.  
  
  그리고 어렵지 않게 구현 완료~ 👊👊👊
```
try:
result = getDataPortalSearch(input(), 'json')

json_data = json.loads(result)                                   # 파일이 아니므로 loads
station_data = json_data['getTblBusinfoeqStusInfo']['body']['items']['item']

import folium

lat = []
lng = []

for item in station_data:
    lat.append(float(item['lat']))
    lng.append(float(item['lng']))

scale = max(max(lat) - min(lat), max(lng) - min(lng))
value = 18

if scale >= 1 and scale <=1.5:
    value = 9
elif scale >= 0.6 and scale <= 0.9:
    value = 10
elif scale >= 0.5 and scale <= 0.1:
    value = 11
else: value = 12

print(value)

lat = 0
lng = 0

for item in station_data:
    lat += float(item['lat'])
    lng += float(item['lng'])

m = folium.Map(location = [lat / len(station_data), lng / len(station_data)], zoom_start = value)

for item in station_data:
    stop_str = '<h4>' + item['stationLoc'] + '</h4> (' + item['stationNum'] + ') ' + item['addr']
    iframe = folium.IFrame(stop_str)
    popup = folium.Popup(iframe, min_width = 200, max_width = 200)
    folium.Marker(location = [item['lat'], item['lng']],
                popup = popup).add_to(m)

except Exception as e:
    print('No data')
```

### 💬 느낀점 

  웹 크롤링은 확실히 결과를 계속 도출되니까 아주 조금, 아주 조금 더 재밌는 것 같다. (아주 조금…….)
